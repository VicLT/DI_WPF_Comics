<UserControl x:Class="Lamas_Victor_ComicsWPF.Views.ComicsOperacionesView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="clr-namespace:Lamas_Victor_ComicsWPF.ViewModels"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:Lamas_Victor_ComicsWPF.Views"
             xmlns:vr="clr-namespace:Lamas_Victor_ComicsWPF.ValidationRules"
             mc:Ignorable="d" 
             d:DesignHeight="450"
             d:DesignWidth="800">

    <UserControl.Resources>
        <ControlTemplate x:Key="ValidationErrorTemplate">
            <StackPanel Orientation="Vertical">
                <Border BorderBrush="Red"
                        BorderThickness="1">
                    <!-- Placeholder for the TextBox itself -->
                    <AdornedElementPlaceholder x:Name="AdornedElement"/>
                </Border>
                <Border>
                    <ItemsControl ItemsSource="{Binding}"
                                  HorizontalAlignment="Left">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding ErrorContent}"
                                           TextAlignment="Center"
                                           Foreground="Red"
                                           FontWeight="Bold"
                                           Margin="0,5,0,0"/>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </Border>
            </StackPanel>
        </ControlTemplate>

        <Style TargetType="TextBox">
            <Style.Triggers>
                <DataTrigger Binding="{Binding DataContext.ModoOp, RelativeSource={RelativeSource AncestorType=UserControl}}" Value="ELIMINAR">
                    <Setter Property="IsEnabled" Value="False"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="ComboBox">
            <Style.Triggers>
                <DataTrigger Binding="{Binding DataContext.ModoOp, RelativeSource={RelativeSource AncestorType=UserControl}}"
                             Value="ELIMINAR">
                    <Setter Property="IsEnabled"
                            Value="False"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </UserControl.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="0.75*" />
            <RowDefinition Height="*" />
            <RowDefinition Height="0.5*" />
            <RowDefinition Height="*" />
            <RowDefinition Height="0.5*" />
            <RowDefinition Height="*" />
            <RowDefinition Height="0.5*" />
            <RowDefinition Height="*" />
            <RowDefinition Height="0.5*" />
            <RowDefinition Height="*" />
            <RowDefinition Height="0.5*" />
            <RowDefinition Height="*" />
            <RowDefinition Height="0.5*" />
            <RowDefinition Height="2*" />
        </Grid.RowDefinitions>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>
        
        <TextBlock Grid.Row="0"
                   Grid.Column="0"
                   Grid.ColumnSpan="3"
                   Text="{Binding ModoOp}"
                   FontSize="18"
                   FontWeight="Bold"
                   HorizontalAlignment="Center"/>

        <TextBlock Grid.Row="1"
                   Grid.Column="0"
                   Margin="0,0,10,0"
                   VerticalAlignment="Center"
                   HorizontalAlignment="Right"
                   Text="NOMBRE"/>

        <TextBox Grid.Row="1"
                 Grid.Column="1"
                 VerticalContentAlignment="Center"
                 FontSize="14"
                 Height="30"
                 Margin="15,0,20,0"
                 VerticalAlignment="Center"
                 HorizontalAlignment="Stretch"
                 Validation.ErrorTemplate="{StaticResource ValidationErrorTemplate}">
            <TextBox.Text>
                <Binding Path="Comic.Nombre"
                         Mode="TwoWay"
                         UpdateSourceTrigger="PropertyChanged"
                         ValidatesOnNotifyDataErrors="True">
                    <Binding.ValidationRules>
                        <vr:ComicsTextoValidationRules MinLength="2"
                                                       MaxLength="150"/>
                    </Binding.ValidationRules>
                </Binding>
            </TextBox.Text>
        </TextBox>

        <TextBlock Grid.Row="3"
                   Grid.Column="0"
                   Margin="0,0,10,0"
                   VerticalAlignment="Center"
                   HorizontalAlignment="Right"
                   Text="AUTOR"/>

        <ComboBox Grid.Row="3"
                  Grid.Column="1"
                  ItemsSource="{Binding Autores}"
                  Height="30"
                  VerticalContentAlignment="Center"
                  FontSize="14"
                  Margin="15,0,20,0"
                  VerticalAlignment="Center"
                  HorizontalAlignment="Stretch"
                  DisplayMemberPath="NombreCompleto">
            <ComboBox.SelectedValue>
                <Binding Path="Comic.Autor"
                         Mode="TwoWay"
                         UpdateSourceTrigger="PropertyChanged"
                         ValidatesOnNotifyDataErrors="True">
                    <Binding.ValidationRules>
                        <vr:ComboBoxValidationRules />
                    </Binding.ValidationRules>
                </Binding>
            </ComboBox.SelectedValue>
        </ComboBox>

        <TextBlock Grid.Row="5"
                   Grid.Column="0"
                   Margin="0,0,10,0"
                   VerticalAlignment="Center"
                   HorizontalAlignment="Right"
                   Text="EDITORIAL"/>

        <ComboBox Grid.Row="5"
                  Grid.Column="1"
                  ItemsSource="{Binding Editoriales}"
                  Height="30"
                  VerticalContentAlignment="Center"
                  FontSize="14"
                  Margin="15,0,20,0"
                  VerticalAlignment="Center"
                  HorizontalAlignment="Stretch"
                  DisplayMemberPath="Nombre">
            <ComboBox.SelectedValue>
                <Binding Path="Comic.Editorial"
                         Mode="TwoWay"
                         UpdateSourceTrigger="PropertyChanged"
                         ValidatesOnNotifyDataErrors="True">
                    <Binding.ValidationRules>
                        <vr:ComboBoxValidationRules />
                    </Binding.ValidationRules>
                </Binding>
            </ComboBox.SelectedValue>
        </ComboBox>

        <TextBlock Grid.Row="7"
                   Grid.Column="0"
                   Margin="0,0,10,0"
                   VerticalAlignment="Center"
                   HorizontalAlignment="Right"
                   Text="PRECIO VENTA"/>

        <TextBox Grid.Row="7"
                 Grid.Column="1"
                 Height="30"
                 Margin="15,0,20,0"
                 VerticalContentAlignment="Center"
                 FontSize="14"
                 VerticalAlignment="Center"
                 HorizontalAlignment="Stretch"
                 Validation.ErrorTemplate="{StaticResource ValidationErrorTemplate}">
            <TextBox.Text>
                <Binding Path="Comic.PrecioVenta"
                         Mode="TwoWay"
                         UpdateSourceTrigger="LostFocus"
                         ValidatesOnNotifyDataErrors="True">
                    <Binding.ValidationRules>
                        <vr:ComicsPrecioValidationRules Min="1"
                                                        Max="99999999"/>
                    </Binding.ValidationRules>
                </Binding>
            </TextBox.Text>
        </TextBox>

        <TextBlock Grid.Row="9"
                   Grid.Column="0"
                   Margin="0,0,10,0"
                   VerticalAlignment="Center"
                   HorizontalAlignment="Right"
                   Text="PRECIO COMPRA"/>

        <TextBox Grid.Row="9"
                 Grid.Column="1"
                 Height="30"
                 Margin="15,0,20,0"
                 VerticalContentAlignment="Center"
                 FontSize="14"
                 VerticalAlignment="Center"
                 HorizontalAlignment="Stretch"
                 Validation.ErrorTemplate="{StaticResource ValidationErrorTemplate}">
            <TextBox.Text>
                <Binding Path="Comic.PrecioCompra"
                         Mode="TwoWay"
                         UpdateSourceTrigger="LostFocus"
                         ValidatesOnNotifyDataErrors="True">
                    <Binding.ValidationRules>
                        <vr:ComicsPrecioValidationRules Min="1"
                                                        Max="99999999"/>
                    </Binding.ValidationRules>
                </Binding>
            </TextBox.Text>
        </TextBox>

        <TextBlock Grid.Row="11"
                   Grid.Column="0"
                   Margin="0,0,10,0"
                   VerticalAlignment="Center"
                   HorizontalAlignment="Right"
                   Text="STOCK LOCAL"/>

        <TextBox Grid.Row="11"
                 Grid.Column="1"
                 Height="30"
                 Margin="15,0,20,0"
                 VerticalContentAlignment="Center"
                 FontSize="14"
                 VerticalAlignment="Center"
                 HorizontalAlignment="Stretch"
                 Validation.ErrorTemplate="{StaticResource ValidationErrorTemplate}">
            <TextBox.Text>
                <Binding Path="StockLocal"
                         Mode="TwoWay"
                         UpdateSourceTrigger="PropertyChanged"
                         ValidatesOnNotifyDataErrors="True">
                    <Binding.ValidationRules>
                        <vr:ComicsCantidadValidationRules Min="0"
                                                          Max="2147483647"/>
                    </Binding.ValidationRules>
                </Binding>
            </TextBox.Text>
        </TextBox>

        <Button Grid.Row="13"
                Grid.Column="1"
                Content="CANCELAR"
                Command="{Binding ShowComicsViewCommand}"
                Width="100"
                Height="35"
                Margin="15,0,0,0"
                Foreground="Red"
                FontWeight="Bold"
                HorizontalAlignment="Left"/>
        
        <Button Grid.Row="13"
                Grid.Column="1"
                Content="CONFIRMAR"
                Command="{Binding ExecuteOperationCommand}"
                Width="100"
                Height="35"
                Margin="0,0,15,0"
                Foreground="Blue"
                FontWeight="Bold"
                HorizontalAlignment="Right"/>
    </Grid>
</UserControl>
